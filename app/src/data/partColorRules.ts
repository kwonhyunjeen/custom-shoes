import type { ShoePart, ColorOption } from "@/types/customization";
import z from "zod";

export type PartColorRule = ColorOption["id"][];

export const PART_COLOR_RULES = {
  collar: [
    "black",
    "white",
    "gray",
    "golden",
    "red",
    "navy",
    "burgundy",
    "brown",
  ],
  laces: ["black", "white", "gray", "cream", "red", "navy", "brown"],
  insole: ["black", "white", "cream", "light-gray", "navy"],
  mudguard: [
    "black",
    "gray",
    "white",
    "cream",
    "golden",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "red",
    "brown",
  ],
  midsole: [
    "black",
    "gray",
    "white",
    "cream",
    "royal-blue",
    "pink",
    "red",
    "brown",
  ],
  foxing: [
    "black",
    "gray",
    "white",
    "cream",
    "orange",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "red",
  ],
  quarter: [
    "black",
    "gray",
    "white",
    "cream",
    "light-gray",
    "golden",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "burgundy",
    "red",
    "orange",
    "purple",
    "teal",
    "brown",
    "coral",
    "cocoa",
  ],
  logo: [
    "black",
    "gray",
    "white",
    "cream",
    "orange",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "red",
  ],
  outsole: [
    "black",
    "gray",
    "white",
    "cream",
    "royal-blue",
    "pink",
    "red",
    "brown",
  ],
  toe: [
    "black",
    "gray",
    "white",
    "cream",
    "orange",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "red",
  ],
  tongue: ["black", "white", "gray", "brown", "navy"],
  vamp: [
    "black",
    "gray",
    "white",
    "cream",
    "orange",
    "olive",
    "dark-green",
    "royal-blue",
    "navy",
    "pink",
    "red",
  ],
} as const satisfies Record<ShoePart["id"], PartColorRule>;

const createColorZodUnion = <T extends readonly string[]>(colors: T) => {
  const [first, ...rest] = colors;
  return z.union([
    z.literal(first),
    ...rest.map((color) => z.literal(color)),
  ]) as z.ZodUnion<[z.ZodLiteral<T[0]>, ...Array<z.ZodLiteral<T[number]>>]>;
};

export const PART_COLOR_RULES_SCHEMA = z.object({
  collar: createColorZodUnion(PART_COLOR_RULES.collar),
  laces: createColorZodUnion(PART_COLOR_RULES.laces),
  insole: createColorZodUnion(PART_COLOR_RULES.insole),
  mudguard: createColorZodUnion(PART_COLOR_RULES.mudguard),
  midsole: createColorZodUnion(PART_COLOR_RULES.midsole),
  foxing: createColorZodUnion(PART_COLOR_RULES.foxing),
  quarter: createColorZodUnion(PART_COLOR_RULES.quarter),
  logo: createColorZodUnion(PART_COLOR_RULES.logo),
  outsole: createColorZodUnion(PART_COLOR_RULES.outsole),
  toe: createColorZodUnion(PART_COLOR_RULES.toe),
  tongue: createColorZodUnion(PART_COLOR_RULES.tongue),
  vamp: createColorZodUnion(PART_COLOR_RULES.vamp),
});
